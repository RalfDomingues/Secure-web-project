<h1>Painel</h1>

<p>Bem-vindo! Aqui vocÃª pode enviar arquivos e ver seus registros de auditoria.</p>

<form action="/upload" method="POST" enctype="multipart/form-data" class="mt-3">
  <!-- ðŸ”’ Campo CSRF obrigatÃ³rio -->
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">

  <div class="mb-3">
    <label for="file" class="form-label">Escolha um arquivo para enviar:</label>
    <input type="file" id="file" name="file" class="form-control" required>
  </div>

  <button type="submit" class="btn btn-primary">Enviar</button>
</form>

<hr>

<h2>Ãšltimos eventos</h2>

<table class="table table-striped mt-3">
  <thead>
    <tr>
      <th>Tipo</th>
      <th>Metadados</th>
      <th>IP</th>
      <th>Data</th>
    </tr>
  </thead>
  <tbody>
    <% if (logs && logs.length > 0) { %>
      <% logs.forEach(log => { %>
        <tr>
          <td><%= log.event_type %></td>
          <td><%= log.event_metadata %></td>
          <td><%= log.ip_addr %></td>
          <td><%= log.created_at.toLocaleString() %></td>
        </tr>
      <% }) %>
    <% } else { %>
      <tr>
        <td colspan="4">Nenhum log encontrado.</td>
      </tr>
    <% } %>
  </tbody>
</table>

<form action="/logout" method="POST" class="mt-4">
  <!-- ðŸ”’ TambÃ©m precisa do CSRF -->
  <input type="hidden" name="_csrf" value="<%= csrfToken %>">
  <button type="submit" class="btn btn-danger">Sair</button>
</form>
